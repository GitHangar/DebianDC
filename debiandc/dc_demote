#
cd /usr/local/debiandc
source common-value

zenity --question --text="This DC will be remowed from domain environment.\nDo you approve this action?" --default-cancel --ellipsize

DRETURN=$?

if [ "$DRETURN" = "1" ]
then
zenity --info --text="You are canceled process" --ellipsize
bash operations_dc
exit 1
fi

PASSWORD=$(zenity --entry --text="Administrator Password" --hide-text)
DEMOTE_RESULT=FALSE
samba-tool domain demote -U Administrator --password=$PASSWORD && DEMOTE_RESULT=TRUE

if [ "$DEMOTE_RESULT" = "FALSE" ]
then
zenity --error --text="The demote operation failed.\nPlease check the replication output." --ellipsize

bash operations_dc
exit 1
fi

